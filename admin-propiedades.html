<!doctype html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <title>Admin - Análisis de Propiedades | Imalá</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="Administración de reportes de propiedades y movimientos" name="description" />
    <meta content="Imalá" name="author" />
    <link rel="shortcut icon" href="assets/images/imala.ico">

    <!-- App css -->
    <link href="assets/css/bootstrap.min.css" id="bootstrap-style" rel="stylesheet" type="text/css" />
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/app.min.css" id="app-style" rel="stylesheet" type="text/css" />

    <style>
        .card-upload {
            border-radius: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            border: none;
        }

        .card-upload:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }

        .badge-file-type {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .import-log {
            max-height: 260px;
            overflow-y: auto;
            font-size: 0.9rem;
        }

        .text-monospace-small {
            font-family: monospace;
            font-size: 0.8rem;
        }
    </style>
</head>

<body data-topbar="dark">

    <!-- Begin page -->
    <div id="layout-wrapper">

        <!-- Topbar -->
        <header id="page-topbar">
            <div class="navbar-header">
                <div class="d-flex">
                    <!-- LOGO -->
                    <div class="navbar-brand-box">
                        <a href="index.html" class="logo logo-dark">
                            <span class="logo-sm">
                                <img src="assets/images/logo-sm.png" alt="" height="22">
                            </span>
                            <span class="logo-lg">
                                <img src="assets/images/logo-dark.png" alt="" height="20">
                            </span>
                        </a>

                        <a href="index.html" class="logo logo-light">
                            <span class="logo-sm">
                                <img src="assets/images/logo-sm.png" alt="" height="22">
                            </span>
                            <span class="logo-lg">
                                <img src="assets/images/logo-light.png" alt="" height="20">
                            </span>
                        </a>
                    </div>

                    <button type="button" class="btn btn-sm px-3 font-size-16 header-item waves-effect"
                        id="vertical-menu-btn">
                        <i class="fa fa-fw fa-bars"></i>
                    </button>
                </div>

                <div class="d-flex">

                    <div class="dropdown d-inline-block">
                        <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown"
                            data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="rounded-circle header-profile-user" src="assets/images/users/avatar-1.jpg"
                                alt="Header Avatar">
                            <span class="d-none d-xl-inline-block ms-1" key="t-username" id="header-user-name">Usuario</span>
                            <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end">
                            <!-- item-->
                            <a class="dropdown-item" href="perfil.html"><i
                                    class="mdi mdi-account-circle-outline font-size-16 align-middle me-1"></i> <span
                                    key="t-profile">Perfil</span></a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#" id="btn-logout"><i
                                    class="mdi mdi-power font-size-16 align-middle me-1 text-danger"></i> <span
                                    key="t-logout">Cerrar sesión</span></a>
                        </div>
                    </div>

                </div>
            </div>
        </header>
        <!-- End Topbar -->

        <!-- ========== Left Sidebar Start ========== -->
        <div class="vertical-menu">

            <div data-simplebar class="h-100">

                <!--- Sidemenu -->
                <div id="sidebar-menu">
                    <!-- Left Menu Start -->
                    <ul class="metismenu list-unstyled" id="side-menu">
                        <li class="menu-title" key="t-menu">Menú</li>

                        <li>
                            <a href="index.html" class="waves-effect">
                                <i class="mdi mdi-view-dashboard-outline"></i>
                                <span key="t-dashboard">Dashboard</span>
                            </a>
                        </li>

                        <li>
                            <a href="tracking.html" class="waves-effect">
                                <i class="mdi mdi-calendar-check"></i>
                                <span>Tracking Mensual</span>
                            </a>
                        </li>

                        <li>
                            <a href="charts.html" class="waves-effect">
                                <i class="mdi mdi-chart-line"></i>
                                <span>Mis Resultados</span>
                            </a>
                        </li>

                        <li class="menu-title">Administrador</li>

                        <li>
                            <a href="admin-config.html" class="waves-effect">
                                <i class="mdi mdi-cog-outline"></i>
                                <span>Configuración general</span>
                            </a>
                        </li>

                        <li class="mm-active">
                            <a href="admin-propiedades.html" class="waves-effect">
                                <i class="mdi mdi-home-analytics"></i>
                                <span>Análisis de propiedades</span>
                            </a>
                        </li>

                    </ul>
                </div>
                <!-- Sidebar -->
            </div>
        </div>
        <!-- Left Sidebar End -->

        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">
                <div class="container-fluid">

                    <!-- start page title -->
                    <div class="row">
                        <div class="col-12">
                            <div
                                class="page-title-box d-flex align-items-center justify-content-between flex-wrap gap-2">
                                <h4 class="mb-0">Carga de reportes de propiedades</h4>
                            </div>
                        </div>
                    </div>
                    <!-- end page title -->

                    <!-- Info -->
                    <div class="row">
                        <div class="col-12">
                            <div class="alert alert-info mb-3">
                                <strong>Importante:</strong> Esta sección administra <u>solo</u> los datos de
                                análisis de propiedades (inventario, captaciones, reservas y cierres) a partir de los
                                reportes del sistema externo. No modifica el tracking actual de los agentes.
                            </div>
                        </div>
                    </div>

                    <!-- Contexto + uploads -->
                    <div class="row">
                        <!-- Contexto -->
                        <div class="col-lg-4">
                            <div class="card card-upload">
                                <div class="card-body">
                                    <h5 class="mb-3">Contexto de carga</h5>

                                    <div class="mb-3">
                                        <label class="form-label">Oficina / Equipo</label>
                                        <select id="admin-oficina" class="form-control">
                                            <option value="">Cargando oficinas...</option>
                                        </select>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Año</label>
                                        <input type="number" id="admin-anio" class="form-control" min="2020"
                                            max="2100">
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label">Mes (opcional)</label>
                                        <select id="admin-mes" class="form-control">
                                            <option value="">Todo el año completo</option>
                                            <option value="0">Enero</option>
                                            <option value="1">Febrero</option>
                                            <option value="2">Marzo</option>
                                            <option value="3">Abril</option>
                                            <option value="4">Mayo</option>
                                            <option value="5">Junio</option>
                                            <option value="6">Julio</option>
                                            <option value="7">Agosto</option>
                                            <option value="8">Septiembre</option>
                                            <option value="9">Octubre</option>
                                            <option value="10">Noviembre</option>
                                            <option value="11">Diciembre</option>
                                        </select>
                                    </div>

                                    <div class="text-muted" style="font-size: 0.85rem;">
                                        Para pruebas iniciales podés usar un solo mes. Más adelante podés cargar
                                        archivos anuales completos; el sistema deberá detectar y evitar duplicados.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Inventario -->
                        <div class="col-lg-4">
                            <div class="card card-upload">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h5 class="mb-0">Reporte de Inventario</h5>
                                        <span class="badge bg-primary badge-file-type">Propiedades</span>
                                    </div>
                                    <p class="text-muted mb-2" style="font-size:0.9rem;">
                                        Archivo tipo CSV/XLS con el inventario actual de propiedades (estado, días en
                                        mercado, etc.).
                                    </p>

                                    <div class="mb-3">
                                        <input type="file" id="file-inventario" class="form-control"
                                            accept=".csv,.xls,.xlsx">
                                    </div>

                                    <button id="btn-import-inventario" class="btn btn-primary btn-sm w-100">
                                        Importar inventario
                                    </button>

                                    <div class="mt-2 text-muted text-monospace-small" id="info-inventario">
                                        Ningún archivo seleccionado.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Movimientos -->
                        <div class="col-lg-4">
                            <div class="card card-upload">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h5 class="mb-0">Reporte de Movimientos</h5>
                                        <span class="badge bg-success badge-file-type">Resultados</span>
                                    </div>
                                    <p class="text-muted mb-2" style="font-size:0.9rem;">
                                        Archivo tipo XLS con el histórico de captaciones, reservas, negociaciones y
                                        cierres del período.
                                    </p>

                                    <div class="mb-3">
                                        <input type="file" id="file-movimientos" class="form-control"
                                            accept=".csv,.xls,.xlsx">
                                    </div>

                                    <button id="btn-import-movimientos" class="btn btn-success btn-sm w-100">
                                        Importar movimientos
                                    </button>

                                    <div class="mt-2 text-muted text-monospace-small" id="info-movimientos">
                                        Ningún archivo seleccionado.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Resumen + log -->
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="mb-3">Resumen de la última importación</h5>
                                    <div id="resumen-import" class="text-muted" style="font-size:0.9rem;">
                                        Aún no se ha realizado ninguna importación en esta sesión.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="mb-3">Log de procesos</h5>
                                    <div id="log-import" class="import-log text-monospace-small">
                                        <!-- Líneas de log se agregan desde JS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div> <!-- container-fluid -->
            </div>
            <!-- End Page-content -->

            <footer class="footer">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">
                            © Imalá.
                        </div>
                    </div>
                </div>
            </footer>
        </div>
        <!-- end main content-->

    </div>
    <!-- END layout-wrapper -->

   <script src="assets/libs/jquery/jquery.min.js"></script>
<script src="assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/libs/metismenu/metisMenu.min.js"></script>
<script src="assets/libs/simplebar/simplebar.min.js"></script>
<script src="assets/libs/node-waves/waves.min.js"></script>
<script src="assets/libs/feather-icons/feather.min.js"></script>
<script src="assets/libs/pace-js/pace.min.js"></script>
<script src="assets/js/app.js"></script>

<script type="module" src="firebase-config.js"></script>
<script type="module" src="admin-propiedades.js"></script>
<script type="module" src="header-user.js"></script>


</body>

</html>

